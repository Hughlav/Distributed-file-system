
==================== FINAL INTERFACE ====================
2017-12-13 18:42:16.943176 UTC

interface DFS-0.1.0.0-8jVWvB4mTg1IUkCEEYmdc9:FileServer 8002
  interface hash: 46f90fd6386ab86f37efbed90610500d
  ABI hash: 9b49f091ca5c1a3025beecf8548beda2
  export-list hash: 8c007bd69811614330376f1f7d337d2f
  orphan hash: 693e9af84d3dfcc71e640e005bdc5e2e
  flag hash: 9f824abc175ef353d85c18036ab74a85
  sig of: Nothing
  used TH splices: False
  where
exports:
  FileServer.add
  FileServer.addToFileListRead
  FileServer.addToFileListWrite
  FileServer.checkVer
  FileServer.newFile
  FileServer.newServer
  FileServer.openFileandSend
  FileServer.openFileandSend'
  FileServer.openSocket
  FileServer.readytoclose
  FileServer.removeClientfromCacheList
  FileServer.runConn
  FileServer.updateClientCache
  FileServer.writeFileList
  FileServer.writeFileandClose
  FileServer.CachedBy
  FileServer.File{FileServer.File cachedBy fileVersion}
  FileServer.FileList
module dependencies:
package dependencies: array-0.5.1.1@array-0.5.1.1 base-4.9.1.0
                      containers-0.5.7.1@containers-0.5.7.1
                      deepseq-1.4.2.0@deepseq-1.4.2.0 ghc-prim-0.5.0.0
                      integer-gmp-1.0.0.1
                      network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz
                      stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve
orphans: base-4.9.1.0:GHC.Base base-4.9.1.0:GHC.Float
         network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network.Socket
         stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Monad.STM
family instance modules: base-4.9.1.0:Control.Applicative
                         base-4.9.1.0:Data.Complex base-4.9.1.0:Data.Either
                         base-4.9.1.0:Data.Functor.Const base-4.9.1.0:Data.Functor.Identity
                         base-4.9.1.0:Data.List.NonEmpty base-4.9.1.0:Data.Monoid
                         base-4.9.1.0:Data.Semigroup base-4.9.1.0:Data.Type.Equality
                         base-4.9.1.0:Data.Version base-4.9.1.0:Data.Void
                         base-4.9.1.0:GHC.Exts base-4.9.1.0:GHC.Generics
                         base-4.9.1.0:GHC.IO.Exception base-4.9.1.0:GHC.TypeLits
                         containers-0.5.7.1@containers-0.5.7.1:Data.Map.Base
                         containers-0.5.7.1@containers-0.5.7.1:Data.Set.Base
import  -/  base-4.9.1.0:Control.Concurrent 2ee6a0a58489520b9a96d8fef10380fa
import  -/  base-4.9.1.0:Control.Exception a76dd9666251322fe34dbcca3a0817bf
import  -/  base-4.9.1.0:Control.Monad a6784c5dab0d75c63dabec5a37843f98
import  -/  base-4.9.1.0:Control.Monad.Fix 1847625fb543f2f5c2510a02760c6b1a
import  -/  base-4.9.1.0:Data.Foldable 3e0b6967a1da89945d0e2d47266337a2
import  -/  base-4.9.1.0:Data.OldList 27987919d8da2f92e3f472ca81f730f8
import  -/  base-4.9.1.0:GHC.Base c4231c43c07e46080a26bf94094c7aa1
import  -/  base-4.9.1.0:GHC.Conc.Sync 8d0a228e5fc4d8c110495066f4d52ea1
import  -/  base-4.9.1.0:GHC.Err 3bba35a16538d33d424682ce66876cdd
import  -/  base-4.9.1.0:GHC.IO.Handle ba98a5b34d78cbf48b41fe58a3735c69
import  -/  base-4.9.1.0:GHC.IO.Handle.FD bf0291e0f2b6c0eca5446f986999f1cc
import  -/  base-4.9.1.0:GHC.IO.Handle.Text b65719f3b262b071ab1aabeb72fc9d8b
import  -/  base-4.9.1.0:GHC.IO.Handle.Types 17aa0e2ab137800e3a31992d780c071f
import  -/  base-4.9.1.0:GHC.IO.IOMode 2f5782f93b12a0d860d6d661b9fb405c
import  -/  base-4.9.1.0:GHC.Num 00bfaa7b2f9d6084913c0697a8a49ec8
import  -/  base-4.9.1.0:GHC.Real 82e4e59051a13dba1da63e1e970a69e6
import  -/  base-4.9.1.0:GHC.Show a027f5ac24879eaba752f44aa90fe511
import  -/  base-4.9.1.0:Prelude 22dd289b8469a8fa8dc81cab7b237771
import  -/  base-4.9.1.0:System.Exit 068ba078eb20417d7af66db8b8ab4db1
import  -/  base-4.9.1.0:System.IO c9de64c5f5407c4cf1c52500c4d15200
import  -/  base-4.9.1.0:Text.Read 75c59863e882ebaec4532e9465e2ee9b
import  -/  containers-0.5.7.1@containers-0.5.7.1:Data.Map 0fd5c8559af8bc4b6f38b9cf9ba5a467
import  -/  containers-0.5.7.1@containers-0.5.7.1:Data.Map.Base 8b155a212edaca6c85bcefe65a8bc505
import  -/  ghc-prim-0.5.0.0:GHC.Classes 0bdf3d057a415ec1b84a7b1994efbe47
import  -/  ghc-prim-0.5.0.0:GHC.Types 89f8de4f08018c9177c98d979eae0e45
import  -/  network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network e1c2bc629a33bc735be38b505b5877ff
import  -/  network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network.Socket 52f9b9614bf018ecf5fec5f2570dad23
import  -/  network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network.Socket.Internal 9f052186d90733a29fe9bf6bf8921c1c
import  -/  network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network.Socket.Types 2eb8a83dc42cc86a12e652ce3294cbda
import  -/  stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Concurrent.STM 3662559905a40ae5adbc3e935ac706c8
import  -/  stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Concurrent.STM.TVar 8271fdeaf6f41f205dbe31243cf91390
3673e1d3af2543e7f1d1c8b8b26a900b
  $sdelete_$sgo10 ::
    GHC.Types.Int
    -> Data.Map.Base.Map GHC.Types.Int a1
    -> Data.Map.Base.Map GHC.Types.Int a1
  {- Arity: 2, Strictness: <S,1*U(U)><S,1*U>, Inline: INLINE[0],
     Unfolding: InlineRule (2, True, False)
                (\ @ a1
                   (w :: GHC.Types.Int)
                   (w1 :: Data.Map.Base.Map GHC.Types.Int a1) ->
                 case w of ww { GHC.Types.I# ww1 ->
                 FileServer.$w$sgo10 @ a1 ww1 w1 }) -}
4fb9706b6712b4c776bb0d69ad759807
  $sinsert_$sgo1 ::
    GHC.Base.String
    -> a1
    -> Data.Map.Base.Map GHC.Base.String a1
    -> Data.Map.Base.Map GHC.Base.String a1
  {- Arity: 3, Strictness: <S,1*U><L,U><S,1*U> -}
8ad1dba07856f00a5efad0a506a8f70e
  $sinsert_$sgo10 ::
    GHC.Types.Int
    -> a1
    -> Data.Map.Base.Map GHC.Types.Int a1
    -> Data.Map.Base.Map GHC.Types.Int a1
  {- Arity: 3, Strictness: <S,1*U(U)><L,U><S,1*U>, Inline: INLINE[0],
     Unfolding: InlineRule (3, True, False)
                (\ @ a1
                   (w :: GHC.Types.Int)
                   (w1 :: a1)
                   (w2 :: Data.Map.Base.Map GHC.Types.Int a1) ->
                 case w of ww { GHC.Types.I# ww1 ->
                 FileServer.$w$sgo1 @ a1 ww1 w1 w2 }) -}
6370dff7669bf89b02c1631114898770
  $slookup3 ::
    GHC.Base.String
    -> Data.Map.Base.Map GHC.Base.String a -> GHC.Base.Maybe a
  {- Arity: 2, HasNoCafRefs, Strictness: <S,1*U><S,1*U> -}
f5fd832b553b3471affe577c111eebd1
  $tc'File :: GHC.Types.TyCon
  {- HasNoCafRefs, Strictness: m,
     Unfolding: (GHC.Types.TyCon
                   5704379000045370239##
                   15532876458679974698##
                   FileServer.$trModule
                   FileServer.$tc'File1) -}
ee014d8717a32cd383048da269de43dc
  $tc'File1 :: GHC.Types.TrName
  {- HasNoCafRefs, Strictness: m1,
     Unfolding: (GHC.Types.TrNameS "'File"#) -}
d8c9368cbcf4b1819e133ddaac128094
  $tcFile :: GHC.Types.TyCon
  {- HasNoCafRefs, Strictness: m,
     Unfolding: (GHC.Types.TyCon
                   6617842079838295278##
                   3709925000491039817##
                   FileServer.$trModule
                   FileServer.$tcFile1) -}
1f7e27e08f0205eeb6c77e8a8be19639
  $tcFile1 :: GHC.Types.TrName
  {- HasNoCafRefs, Strictness: m1,
     Unfolding: (GHC.Types.TrNameS "File"#) -}
ddaa4d97501a48fb64d93a3884a83a90
  $trModule :: GHC.Types.Module
  {- HasNoCafRefs, Strictness: m,
     Unfolding: (GHC.Types.Module
                   FileServer.$trModule2
                   FileServer.$trModule1) -}
7ae1b74d4eef2704d340ec6baa12abf2
  $trModule1 :: GHC.Types.TrName
  {- HasNoCafRefs, Strictness: m1,
     Unfolding: (GHC.Types.TrNameS "FileServer"#) -}
a7ebd9a43286dd639dd8b5499a0dd992
  $trModule2 :: GHC.Types.TrName
  {- HasNoCafRefs, Strictness: m1,
     Unfolding: (GHC.Types.TrNameS
                   "DFS-0.1.0.0-8jVWvB4mTg1IUkCEEYmdc9"#) -}
d779306e87ee65804de0e00c1d4d68bf
  $w$sgo1 ::
    GHC.Prim.Int#
    -> a1
    -> Data.Map.Base.Map GHC.Types.Int a1
    -> Data.Map.Base.Map GHC.Types.Int a1
  {- Arity: 3, Strictness: <L,U><L,U><S,1*U>, Inline: [0] -}
a614ada46452b331b8b9a519cf21836e
  $w$sgo10 ::
    GHC.Prim.Int#
    -> Data.Map.Base.Map GHC.Types.Int a1
    -> Data.Map.Base.Map GHC.Types.Int a1
  {- Arity: 2, Strictness: <L,U><S,1*U>, Inline: [0] -}
6a3e57d67837e9b4eb116cd25ee353dc
  $waddToFileListRead ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Prim.TVar#
         GHC.Prim.RealWorld
         (Data.Map.Base.Map GHC.Base.String FileServer.File)
    -> GHC.Prim.Int#
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, GHC.Types.Bool #)
  {- Arity: 5, Strictness: <L,U><S,1*U><S,U><L,U><S,U>, Inline: [0],
     Unfolding: (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: GHC.Base.String)
                   (ww :: GHC.Prim.TVar#
                            GHC.Prim.RealWorld
                            (Data.Map.Base.Map GHC.Base.String FileServer.File))
                   (ww1 :: GHC.Prim.Int#)
                   (w2 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case GHC.Prim.atomically#
                        @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                        (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                         GHC.Prim.readTVar#
                           @ GHC.Prim.RealWorld
                           @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                           ww
                           eta)
                        w2 of ds1 { (#,#) ipv ipv1 ->
                 case FileServer.$slookup3 @ FileServer.File w1 ipv1 of wild {
                   GHC.Base.Nothing
                   -> case FileServer.addToFileListRead2
                      ret_ty (# GHC.Prim.State# GHC.Prim.RealWorld, GHC.Types.Bool #)
                      of {}
                   GHC.Base.Just aFile
                   -> case GHC.Prim.atomically#
                             @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                             (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                              case aFile of wild1 { FileServer.File ds ds2 ->
                              case ds2 of wild2 { GHC.Conc.Sync.TVar tvar# ->
                              GHC.Prim.readTVar#
                                @ GHC.Prim.RealWorld
                                @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                tvar#
                                eta } })
                             ipv of ds2 { (#,#) ipv2 ipv3 ->
                      case FileServer.$wpoly_go10
                             @ GHC.IO.Handle.Types.Handle
                             ww1
                             ipv3 of wild1 {
                        GHC.Base.Nothing
                        -> case GHC.Prim.atomically#
                                  @ ()
                                  (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                                   case aFile of wild2 { FileServer.File ds ds3 ->
                                   case ds3 of wild3 { GHC.Conc.Sync.TVar tvar# ->
                                   case GHC.Prim.writeTVar#
                                          @ GHC.Prim.RealWorld
                                          @ (Data.Map.Base.Map
                                               GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                          tvar#
                                          (FileServer.$w$sgo1
                                             @ GHC.IO.Handle.Types.Handle
                                             ww1
                                             w
                                             ipv3)
                                          eta of s2# { DEFAULT ->
                                   (# s2#, GHC.Tuple.() #) } } })
                                  ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                           (# ipv4, GHC.Types.True #) }
                        GHC.Base.Just aClient -> (# ipv2, GHC.Types.True #) } } } }) -}
7f57cc9488673be4eefc377eb2aca258
  $waddToFileListWrite ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Prim.TVar#
         GHC.Prim.RealWorld
         (Data.Map.Base.Map GHC.Base.String FileServer.File)
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 5, Strictness: <L,U><S,U><S,U><L,U(U)><S,U>, Inline: [0],
     Unfolding: (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: GHC.Base.String)
                   (ww :: GHC.Prim.TVar#
                            GHC.Prim.RealWorld
                            (Data.Map.Base.Map GHC.Base.String FileServer.File))
                   (w2 :: GHC.Types.Int)
                   (w3 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case GHC.Prim.atomically#
                        @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                        (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                         GHC.Prim.readTVar#
                           @ GHC.Prim.RealWorld
                           @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                           ww
                           eta)
                        w3 of ds1 { (#,#) ipv ipv1 ->
                 case FileServer.$slookup3 @ FileServer.File w1 ipv1 of wild {
                   GHC.Base.Nothing
                   -> case GHC.Prim.atomically#
                             @ FileServer.File
                             (FileServer.addToFileListWrite2 w w1 w2)
                             ipv of ds2 { (#,#) ipv2 ipv3 ->
                      case GHC.Prim.atomically#
                             @ ()
                             (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                              case ipv3 of wild1 { FileServer.File ds ds3 ->
                              case ds of wild2 { GHC.Conc.Sync.TVar tvar# ->
                              case GHC.Prim.readTVar#
                                     @ GHC.Prim.RealWorld
                                     @ GHC.Types.Int
                                     tvar#
                                     eta of ds4 { (#,#) ipv4 ipv5 ->
                              case GHC.Prim.writeTVar#
                                     @ GHC.Prim.RealWorld
                                     @ GHC.Types.Int
                                     tvar#
                                     (case ipv5 of wild3 { GHC.Types.I# y ->
                                      GHC.Types.I# (GHC.Prim.+# 1# y) })
                                     ipv4 of s2# { DEFAULT ->
                              (# s2#, GHC.Tuple.() #) } } } })
                             ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                      GHC.Prim.atomically#
                        @ ()
                        (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                         case GHC.Prim.writeTVar#
                                @ GHC.Prim.RealWorld
                                @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                                ww
                                (FileServer.$sinsert_$sgo1 @ FileServer.File w1 ipv3 ipv1)
                                eta of s2# { DEFAULT ->
                         (# s2#, GHC.Tuple.() #) })
                        ipv4 } }
                   GHC.Base.Just aFile
                   -> case GHC.Prim.atomically#
                             @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                             (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                              case aFile of wild1 { FileServer.File ds ds2 ->
                              case ds2 of wild2 { GHC.Conc.Sync.TVar tvar# ->
                              GHC.Prim.readTVar#
                                @ GHC.Prim.RealWorld
                                @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                tvar#
                                eta } })
                             ipv of ds2 { (#,#) ipv2 ipv3 ->
                      case w2 of ww1 { GHC.Types.I# ww2 ->
                      case FileServer.$wpoly_go10
                             @ GHC.IO.Handle.Types.Handle
                             ww2
                             ipv3 of wild1 {
                        GHC.Base.Nothing
                        -> case GHC.Prim.atomically#
                                  @ ()
                                  (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                                   case aFile of wild2 { FileServer.File ds ds3 ->
                                   case ds of wild3 { GHC.Conc.Sync.TVar tvar# ->
                                   case GHC.Prim.readTVar#
                                          @ GHC.Prim.RealWorld
                                          @ GHC.Types.Int
                                          tvar#
                                          eta of ds4 { (#,#) ipv4 ipv5 ->
                                   case GHC.Prim.writeTVar#
                                          @ GHC.Prim.RealWorld
                                          @ GHC.Types.Int
                                          tvar#
                                          (case ipv5 of wild4 { GHC.Types.I# y ->
                                           GHC.Types.I# (GHC.Prim.+# 1# y) })
                                          ipv4 of s2# { DEFAULT ->
                                   (# s2#, GHC.Tuple.() #) } } } })
                                  ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                           case GHC.Prim.atomically#
                                  @ GHC.Types.Int
                                  (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                                   case aFile of wild2 { FileServer.File ds ds4 ->
                                   case ds of wild3 { GHC.Conc.Sync.TVar tvar# ->
                                   GHC.Prim.readTVar#
                                     @ GHC.Prim.RealWorld
                                     @ GHC.Types.Int
                                     tvar#
                                     eta } })
                                  ipv4 of ds4 { (#,#) ipv6 ipv7 ->
                           GHC.Prim.atomically#
                             @ ()
                             (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                              case aFile of wild2 { FileServer.File ds ds5 ->
                              case ds5 of wild3 { GHC.Conc.Sync.TVar tvar# ->
                              case GHC.Prim.writeTVar#
                                     @ GHC.Prim.RealWorld
                                     @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                     tvar#
                                     (FileServer.$w$sgo1 @ GHC.IO.Handle.Types.Handle ww2 w ipv3)
                                     eta of s2# { DEFAULT ->
                              (# s2#, GHC.Tuple.() #) } } })
                             ipv6 } }
                        GHC.Base.Just aClient
                        -> GHC.Prim.atomically#
                             @ ()
                             (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                              case aFile of wild2 { FileServer.File ds ds3 ->
                              case ds of wild3 { GHC.Conc.Sync.TVar tvar# ->
                              case GHC.Prim.readTVar#
                                     @ GHC.Prim.RealWorld
                                     @ GHC.Types.Int
                                     tvar#
                                     eta of ds4 { (#,#) ipv4 ipv5 ->
                              case GHC.Prim.writeTVar#
                                     @ GHC.Prim.RealWorld
                                     @ GHC.Types.Int
                                     tvar#
                                     (case ipv5 of wild4 { GHC.Types.I# y ->
                                      GHC.Types.I# (GHC.Prim.+# 1# y) })
                                     ipv4 of s2# { DEFAULT ->
                              (# s2#, GHC.Tuple.() #) } } } })
                             ipv2 } } } } }) -}
342a750a48ba01265cdaa1c4861356f5
  $wopenFileandSend ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Prim.TVar#
         GHC.Prim.RealWorld
         (Data.Map.Base.Map GHC.Base.String FileServer.File)
    -> GHC.Base.String
    -> GHC.Prim.Int#
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 5, Strictness: <L,U><S,U><S,U><L,U><S,U>, Inline: [0],
     Unfolding: (\ (w :: GHC.IO.Handle.Types.Handle)
                   (ww :: GHC.Prim.TVar#
                            GHC.Prim.RealWorld
                            (Data.Map.Base.Map GHC.Base.String FileServer.File))
                   (w1 :: GHC.Base.String)
                   (ww1 :: GHC.Prim.Int#)
                   (w2 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case FileServer.$waddToFileListRead
                        w
                        w1
                        ww
                        ww1
                        w2 of ds1 { (#,#) ipv ipv1 ->
                 case ipv1 of wild {
                   GHC.Types.False
                   -> case GHC.IO.Handle.Text.hPutStr2
                             GHC.IO.Handle.FD.stdout
                             FileServer.openFileandSend_reply
                             GHC.Types.True
                             ipv of ds2 { (#,#) ipv2 ipv3 ->
                      GHC.IO.Handle.Text.hPutStr2
                        w
                        FileServer.openFileandSend_reply
                        GHC.Types.True
                        ipv2 }
                   GHC.Types.True
                   -> case GHC.IO.Handle.FD.openFile1
                             w1
                             GHC.IO.IOMode.ReadMode
                             ipv of ds2 { (#,#) ipv2 ipv3 ->
                      case GHC.IO.Handle.Text.hGetContents1
                             ipv3
                             ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                      GHC.IO.Handle.Text.hPutStr2
                        w
                        (GHC.Base.++ @ GHC.Types.Char ipv5 FileServer.openFileandSend2)
                        GHC.Types.True
                        ipv4 } } } }) -}
359cf0cfb9d21a45a3bdb01a6b62a098
  $wopenFileandSend' ::
    GHC.Types.Int
    -> GHC.Base.String
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 3, Strictness: <L,1*U(U)><L,U><S,U>, Inline: [0],
     Unfolding: (\ (w :: GHC.Types.Int)
                   (w1 :: GHC.Base.String)
                   (w2 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case Network.connectTo1
                        FileServer.openFileandSend'4
                        (Network.PortNumber
                           (case w of wild { GHC.Types.I# i ->
                            case {__pkg_ccall network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz htons GHC.Prim.Word#
                                                                                                           -> GHC.Prim.State#
                                                                                                                GHC.Prim.RealWorld
                                                                                                           -> (# GHC.Prim.State#
                                                                                                                   GHC.Prim.RealWorld,
                                                                                                                 GHC.Prim.Word# #)}
                                   (GHC.Prim.narrow16Word# (GHC.Prim.int2Word# i))
                                   GHC.Prim.realWorld# of wild1 { (#,#) ds ds1 ->
                            (GHC.Word.W16# (GHC.Prim.narrow16Word# ds1))
                              `cast`
                            (Sym (Network.Socket.Types.N:PortNumber[0])) } }))
                        w2 of ds1 { (#,#) ipv ipv1 ->
                 case GHC.IO.Handle.Text.hPutStr2
                        GHC.IO.Handle.FD.stdout
                        FileServer.openFileandSend'3
                        GHC.Types.True
                        ipv of ds2 { (#,#) ipv2 ipv3 ->
                 case GHC.IO.Handle.Text.hPutStr2
                        ipv1
                        (GHC.CString.unpackAppendCString# "UPDATE "# w1)
                        GHC.Types.True
                        ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                 FileServer.openFileandSend'2 ipv1 w1 ipv4 } } }) -}
dd0f417e0379c4feb06d883d07f6e7ce
  $wpoly_go10 ::
    GHC.Prim.Int#
    -> Data.Map.Base.Map GHC.Types.Int a -> GHC.Base.Maybe a
  {- Arity: 2, HasNoCafRefs, Strictness: <L,U><S,1*U>, Inline: [0] -}
50294e4c115d20837769e17522ddb77f
  $wremoveClientfromCacheList ::
    GHC.Base.String
    -> GHC.Prim.Int#
    -> GHC.Prim.TVar#
         GHC.Prim.RealWorld
         (Data.Map.Base.Map GHC.Base.String FileServer.File)
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 4, Strictness: <S,1*U><L,U><S,U><S,U>, Inline: [0],
     Unfolding: (\ (w :: GHC.Base.String)
                   (ww :: GHC.Prim.Int#)
                   (ww1 :: GHC.Prim.TVar#
                             GHC.Prim.RealWorld
                             (Data.Map.Base.Map GHC.Base.String FileServer.File))
                   (w1 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 GHC.Prim.atomically#
                   @ ()
                   (\ (s :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                    case GHC.Prim.readTVar#
                           @ GHC.Prim.RealWorld
                           @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                           ww1
                           s of ds1 { (#,#) ipv ipv1 ->
                    case FileServer.$slookup3 @ FileServer.File w ipv1 of wild {
                      GHC.Base.Nothing
                      -> case FileServer.removeClientfromCacheList3
                         ret_ty (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
                         of {}
                      GHC.Base.Just aFile
                      -> case aFile of wild1 { FileServer.File ds ds2 ->
                         case ds2 of wild2 { GHC.Conc.Sync.TVar tvar# ->
                         case GHC.Prim.readTVar#
                                @ GHC.Prim.RealWorld
                                @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                tvar#
                                ipv of ds3 { (#,#) ipv2 ipv3 ->
                         case FileServer.$wpoly_go10
                                @ GHC.IO.Handle.Types.Handle
                                ww
                                ipv3 of wild3 {
                           GHC.Base.Nothing
                           -> case FileServer.removeClientfromCacheList2
                              ret_ty (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
                              of {}
                           GHC.Base.Just aClient
                           -> case GHC.Prim.writeTVar#
                                     @ GHC.Prim.RealWorld
                                     @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                     tvar#
                                     (FileServer.$w$sgo10 @ GHC.IO.Handle.Types.Handle ww ipv3)
                                     ipv2 of s2# { DEFAULT ->
                              (# s2#, GHC.Tuple.() #) } } } } } } })
                   w1) -}
6b240b5e4823b50e9ae2f4376dbd493d
  $wrunConn ::
    GHC.IO.Handle.Types.Handle
    -> FileServer.FileList
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 3, Strictness: <S,U><L,U(U)><S,U>, Inline: [0] -}
f905b06e4962ebc08cc9e52f9bb69949
  $wupdateClientCache ::
    GHC.Prim.TVar#
      GHC.Prim.RealWorld
      (Data.Map.Base.Map GHC.Base.String FileServer.File)
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 4, Strictness: <S,U><S,U><L,1*U(U)><S,U>, Inline: [0],
     Unfolding: (\ (ww :: GHC.Prim.TVar#
                            GHC.Prim.RealWorld
                            (Data.Map.Base.Map GHC.Base.String FileServer.File))
                   (w :: GHC.Base.String)
                   (w1 :: GHC.Types.Int)
                   (w2 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case GHC.Prim.atomically#
                        @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                        (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                         GHC.Prim.readTVar#
                           @ GHC.Prim.RealWorld
                           @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                           ww
                           eta)
                        w2 of ds1 { (#,#) ipv ipv1 ->
                 case FileServer.$slookup3 @ FileServer.File w ipv1 of wild {
                   GHC.Base.Nothing
                   -> case FileServer.updateClientCache2
                      ret_ty (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
                      of {}
                   GHC.Base.Just aFile
                   -> case GHC.Prim.atomically#
                             @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                             (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                              case aFile of wild1 { FileServer.File ds ds2 ->
                              case ds2 of wild2 { GHC.Conc.Sync.TVar tvar# ->
                              GHC.Prim.readTVar#
                                @ GHC.Prim.RealWorld
                                @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                                tvar#
                                eta } })
                             ipv of ds2 { (#,#) ipv2 ipv3 ->
                      let {
                        ports :: [GHC.Types.Int]
                        = Data.Map.Base.keys1
                            @ GHC.IO.Handle.Types.Handle
                            @ GHC.Types.Int
                            (GHC.Types.[] @ GHC.Types.Int)
                            (FileServer.$sdelete_$sgo10 @ GHC.IO.Handle.Types.Handle w1 ipv3)
                      } in
                      case GHC.IO.Handle.Text.hPutStr2
                             GHC.IO.Handle.FD.stdout
                             (GHC.Show.$fShow[]_$s$cshow ports)
                             GHC.Types.True
                             ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                      letrec {
                        go :: [GHC.Types.Int]
                              -> GHC.Prim.State# GHC.Prim.RealWorld
                              -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
                          {- Arity: 2, Strictness: <S,1*U><S,U> -}
                        = \ (ds :: [GHC.Types.Int])
                            (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                          case ds of wild1 {
                            [] -> (# eta, GHC.Tuple.() #)
                            : y ys
                            -> case FileServer.$wopenFileandSend'
                                      y
                                      w
                                      eta of ds4 { (#,#) ipv6 ipv7 ->
                               go ys ipv6 } }
                      } in
                      go ports ipv4 } } } }) -}
c49d77d26295e8660232e6ce6e63d814
  $wwriteFileList ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Prim.TVar#
         GHC.Prim.RealWorld
         (Data.Map.Base.Map GHC.Base.String FileServer.File)
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 6, Strictness: <L,U><S,U><L,1*U><L,U(U)><S,U><S,U>,
     Inline: [0],
     Unfolding: (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: GHC.Base.String)
                   (w2 :: GHC.Base.String)
                   (w3 :: GHC.Types.Int)
                   (ww :: GHC.Prim.TVar#
                            GHC.Prim.RealWorld
                            (Data.Map.Base.Map GHC.Base.String FileServer.File))
                   (w4 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case FileServer.$waddToFileListWrite
                        w
                        w1
                        ww
                        w3
                        w4 of ds1 { (#,#) ipv ipv1 ->
                 case FileServer.writeFileList2
                        w1
                        w2
                        ipv of ds2 { (#,#) ipv2 ipv3 ->
                 case FileServer.$wupdateClientCache
                        ww
                        w1
                        w3
                        ipv2 of ds3 { (#,#) ipv4 ipv5 ->
                 (# ipv4, GHC.Tuple.() #) } } }) -}
75e75c94a0dceec6d2ef2468be1a76cf
  type CachedBy =
    GHC.Conc.Sync.TVar
      (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
582c7aa8cf37ce60fa7b64f1443625e2
  data File
    = File {fileVersion :: GHC.Conc.Sync.TVar GHC.Types.Int,
            cachedBy :: FileServer.CachedBy}
abf8b1e6632948394919ab9e43ce716f
  type FileList =
    GHC.Conc.Sync.TVar
      (Data.Map.Base.Map GHC.Base.String FileServer.File)
06c14a74b19e8a94fe14b62e9ed67124
  add :: GHC.Types.Int -> GHC.Types.Int -> GHC.Types.Int
  {- Arity: 2, HasNoCafRefs, Strictness: <S(S),1*U(U)><S(S),1*U(U)>m,
     Unfolding: InlineRule (0, True, True) GHC.Num.$fNumInt_$c+ -}
b736a2fcc500c4133473bbfe92daf87b
  addToFileListRead ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> FileServer.FileList
    -> GHC.Types.Int
    -> GHC.Types.IO GHC.Types.Bool
  {- Arity: 5, Strictness: <L,U><S,1*U><S(S),1*U(U)><S,U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.addToFileListRead1
                  `cast`
                (<GHC.IO.Handle.Types.Handle>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <FileServer.FileList>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R Sym (GHC.Types.N:IO[0] <GHC.Types.Bool>_R)) -}
b1add5d4c72c4259458b5ba4bb94929f
  addToFileListRead1 ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> FileServer.FileList
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, GHC.Types.Bool #)
  {- Arity: 5, Strictness: <L,U><S,1*U><S(S),1*U(U)><S,U(U)><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (5, True, False)
                (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: GHC.Base.String)
                   (w2 :: FileServer.FileList)
                   (w3 :: GHC.Types.Int)
                   (w4 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case w2 of ww { GHC.Conc.Sync.TVar ww1 ->
                 case w3 of ww2 { GHC.Types.I# ww3 ->
                 FileServer.$waddToFileListRead w w1 ww1 ww3 w4 } }) -}
3a16649a23304e39fbb41e6f77b7c79b
  addToFileListRead2 :: GHC.Types.IO GHC.Prim.Any
  {- Strictness: x -}
35a1efec7fa898867d4122632ad24ac9
  addToFileListWrite ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> FileServer.FileList
    -> GHC.Types.Int
    -> GHC.Types.IO ()
  {- Arity: 5, Strictness: <L,U><S,U><S(S),U(U)><L,U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.addToFileListWrite1
                  `cast`
                (<GHC.IO.Handle.Types.Handle>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <FileServer.FileList>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
ab7f9acf5ecba1c3dd66235b87e976af
  addToFileListWrite1 ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> FileServer.FileList
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 5, Strictness: <L,U><S,U><S(S),U(U)><L,U(U)><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (5, True, False)
                (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: GHC.Base.String)
                   (w2 :: FileServer.FileList)
                   (w3 :: GHC.Types.Int)
                   (w4 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case w2 of ww { GHC.Conc.Sync.TVar ww1 ->
                 FileServer.$waddToFileListWrite w w1 ww1 w3 w4 }) -}
0f1d1bb9a2ddc512f5bb4356c0bd4bc4
  addToFileListWrite2 ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, FileServer.File #)
  {- Arity: 4, Strictness: <L,U><L,A><L,1*U(U)><S,U>,
     Unfolding: InlineRule (4, True, False)
                (\ (handle :: GHC.IO.Handle.Types.Handle)
                   (fileName :: GHC.Base.String)
                   (clientPort :: GHC.Types.Int)
                   (s :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case GHC.Prim.newTVar#
                        @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                        @ GHC.Prim.RealWorld
                        (FileServer.$sinsert_$sgo10
                           @ GHC.IO.Handle.Types.Handle
                           clientPort
                           handle
                           (Data.Map.Base.Tip @ GHC.Types.Int @ GHC.IO.Handle.Types.Handle))
                        s of ds { (#,#) ipv ipv1 ->
                 case GHC.Prim.newTVar#
                        @ GHC.Types.Int
                        @ GHC.Prim.RealWorld
                        FileServer.addToFileListWrite3
                        ipv of ds1 { (#,#) ipv2 ipv3 ->
                 (# ipv2,
                    FileServer.File
                      (GHC.Conc.Sync.TVar @ GHC.Types.Int ipv3)
                      (GHC.Conc.Sync.TVar
                         @ (Data.Map.Base.Map GHC.Types.Int GHC.IO.Handle.Types.Handle)
                         ipv1) #) } }) -}
cc956a5fc93743b358ac88eb5d199d58
  addToFileListWrite3 :: GHC.Types.Int
  {- HasNoCafRefs, Strictness: m, Unfolding: (GHC.Types.I# 0#) -}
5c18366e9dca6ba2f2512ccba746dcb5
  cachedBy :: FileServer.File -> FileServer.CachedBy
  RecSel Left FileServer.File
  {- Arity: 1, HasNoCafRefs, Strictness: <S(LS),1*U(A,1*U(U))>m,
     Unfolding: InlineRule (1, True, False)
                (\ (ds :: FileServer.File) ->
                 case ds of wild { FileServer.File ds1 ds2 -> ds2 }) -}
61868c08a718149c69424372d1fae5be
  checkVer ::
    GHC.Base.String
    -> FileServer.FileList -> GHC.Types.IO GHC.Types.Int
  {- Arity: 3, HasNoCafRefs, Strictness: <S,1*U><S(S),1*U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.checkVer1
                  `cast`
                (<GHC.Base.String>_R
                 ->_R <FileServer.FileList>_R
                 ->_R Sym (GHC.Types.N:IO[0] <GHC.Types.Int>_R)) -}
a5e95bad6186e0575f2db05390a68b3c
  checkVer1 ::
    GHC.Base.String
    -> FileServer.FileList
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, GHC.Types.Int #)
  {- Arity: 3, HasNoCafRefs, Strictness: <S,1*U><S(S),1*U(U)><S,U>,
     Unfolding: InlineRule (3, True, False)
                (\ (fileName :: GHC.Base.String)
                   (fileList :: FileServer.FileList)
                   (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 GHC.Prim.atomically#
                   @ GHC.Types.Int
                   (\ (s :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                    case fileList of wild { GHC.Conc.Sync.TVar tvar# ->
                    case GHC.Prim.readTVar#
                           @ GHC.Prim.RealWorld
                           @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                           tvar#
                           s of ds1 { (#,#) ipv ipv1 ->
                    case FileServer.$slookup3
                           @ FileServer.File
                           fileName
                           ipv1 of wild1 {
                      GHC.Base.Nothing -> (# ipv, FileServer.addToFileListWrite3 #)
                      GHC.Base.Just aFile
                      -> case aFile of wild2 { FileServer.File ds ds2 ->
                         case ds of wild3 { GHC.Conc.Sync.TVar tvar#1 ->
                         GHC.Prim.readTVar#
                           @ GHC.Prim.RealWorld
                           @ GHC.Types.Int
                           tvar#1
                           ipv } } } } })
                   eta) -}
1b9f9cb2452bb0b17eb756ffffd5b322
  fileVersion :: FileServer.File -> GHC.Conc.Sync.TVar GHC.Types.Int
  RecSel Left FileServer.File
  {- Arity: 1, HasNoCafRefs, Strictness: <S(SL),1*U(1*U(U),A)>m,
     Unfolding: InlineRule (1, True, False)
                (\ (ds :: FileServer.File) ->
                 case ds of wild { FileServer.File ds1 ds2 -> ds1 }) -}
c038f9d2a3f063e6dd912f7df6d34d7d
  newFile ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Conc.Sync.STM FileServer.File
  {- Arity: 4, Strictness: <L,U><L,A><L,1*U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.addToFileListWrite2
                  `cast`
                (<GHC.IO.Handle.Types.Handle>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R Sym (GHC.Conc.Sync.N:STM[0] <FileServer.File>_R)) -}
8778a71adfaf9124e3dd680cd918a88c
  newServer :: GHC.Types.IO FileServer.FileList
  {- Arity: 1, HasNoCafRefs, Strictness: <S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.newServer1
                  `cast`
                (Sym (GHC.Types.N:IO[0]
                          <GHC.Conc.Sync.TVar
                             (Data.Map.Base.Map GHC.Base.String FileServer.File)>_R)) -}
7f3e6d2d58493b8470ae85e12cbbda4c
  newServer1 ::
    GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld,
          GHC.Conc.Sync.TVar
            (Data.Map.Base.Map GHC.Base.String FileServer.File) #)
  {- Arity: 1, HasNoCafRefs, Strictness: <S,U>,
     Unfolding: InlineRule (1, True, False)
                (\ (s1# :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case GHC.Prim.newTVar#
                        @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                        @ GHC.Prim.RealWorld
                        (Data.Map.Base.Tip @ GHC.Base.String @ FileServer.File)
                        s1# of ds { (#,#) ipv ipv1 ->
                 (# ipv,
                    GHC.Conc.Sync.TVar
                      @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                      ipv1 #) }) -}
81525688e479f665fdb15bf098285b9e
  openFileandSend ::
    GHC.IO.Handle.Types.Handle
    -> FileServer.FileList
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Types.IO ()
  {- Arity: 5, Strictness: <L,U><S(S),1*U(U)><S,U><S,U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.openFileandSend1
                  `cast`
                (<GHC.IO.Handle.Types.Handle>_R
                 ->_R <FileServer.FileList>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
8ddb12bab825b368c90c103316d737d6
  openFileandSend' ::
    GHC.Types.Int
    -> FileServer.FileList -> GHC.Base.String -> GHC.Types.IO ()
  {- Arity: 4, Strictness: <L,1*U(U)><L,A><L,U><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.openFileandSend'1
                  `cast`
                (<GHC.Types.Int>_R
                 ->_R <FileServer.FileList>_R
                 ->_R <GHC.Base.String>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
31c1a59be7a960576afa7b28ed2d20ff
  openFileandSend'1 ::
    GHC.Types.Int
    -> FileServer.FileList
    -> GHC.Base.String
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 4, Strictness: <L,1*U(U)><L,A><L,U><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (4, True, True)
                (\ (w :: GHC.Types.Int)
                   (w1 :: FileServer.FileList)
                   (w2 :: GHC.Base.String)
                   (w3 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 FileServer.$wopenFileandSend' w w2 w3) -}
490f78e84bd0d87cefd29e459ca9ccd2
  openFileandSend'2 ::
    GHC.IO.Handle.Types.Handle
    -> GHC.IO.FilePath
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 3, Strictness: <S,U><L,U><S,U> -}
8a822ebc4f353c11b666eb24cf71234a
  openFileandSend'3 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   "updating client cache"#) -}
e41b029f0c4238f236c66905b5aadbea
  openFileandSend'4 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString# "localhost"#) -}
4283757238543d1610d1fe1e62a12709
  openFileandSend1 ::
    GHC.IO.Handle.Types.Handle
    -> FileServer.FileList
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 5, Strictness: <L,U><S(S),1*U(U)><S,U><S,U(U)><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (5, True, False)
                (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: FileServer.FileList)
                   (w2 :: GHC.Base.String)
                   (w3 :: GHC.Types.Int)
                   (w4 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case w1 of ww { GHC.Conc.Sync.TVar ww1 ->
                 case w3 of ww2 { GHC.Types.I# ww3 ->
                 FileServer.$wopenFileandSend w ww1 w2 ww3 w4 } }) -}
5dcc81de0704a3f8970186c69c0f0a78
  openFileandSend2 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString# "!EOF!"#) -}
05ba4e9b4a3afd53d1898e57c8d449c8
  openFileandSend_reply :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   "That file does not exist"#) -}
8a6540980ed862d22a9914fc4df7381d
  openSocket :: GHC.Types.Int -> GHC.Types.IO ()
  {- Arity: 2, Strictness: <L,1*U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.openSocket1
                  `cast`
                (<GHC.Types.Int>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
55074e9dea2b7e7b6865ef02ab963d91
  openSocket1 ::
    GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 2, Strictness: <L,1*U(U)><S,U>,
     Unfolding: (\ (portNum :: GHC.Types.Int)
                   (s :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case Network.listenOn1
                        (Network.PortNumber
                           (case portNum of wild { GHC.Types.I# i ->
                            case {__pkg_ccall network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz htons GHC.Prim.Word#
                                                                                                           -> GHC.Prim.State#
                                                                                                                GHC.Prim.RealWorld
                                                                                                           -> (# GHC.Prim.State#
                                                                                                                   GHC.Prim.RealWorld,
                                                                                                                 GHC.Prim.Word# #)}
                                   (GHC.Prim.narrow16Word# (GHC.Prim.int2Word# i))
                                   GHC.Prim.realWorld# of wild1 { (#,#) ds ds1 ->
                            (GHC.Word.W16# (GHC.Prim.narrow16Word# ds1))
                              `cast`
                            (Sym (Network.Socket.Types.N:PortNumber[0])) } }))
                        s of ds1 { (#,#) ipv ipv1 ->
                 case GHC.Prim.fork#
                        @ (GHC.Types.IO ())
                        (\ (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                         GHC.Prim.catch#
                           @ ()
                           @ GHC.Exception.SomeException
                           (FileServer.openSocket4 ipv1)
                           GHC.Conc.Sync.childHandler1
                           eta)
                          `cast`
                        (Sym (GHC.Types.N:IO[0] <()>_R))
                        ipv of ds { (#,#) ipv2 ipv3 ->
                 case GHC.Prim.newTVar#
                        @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                        @ GHC.Prim.RealWorld
                        (Data.Map.Base.Tip @ GHC.Base.String @ FileServer.File)
                        ipv2 of ds2 { (#,#) ipv4 ipv5 ->
                 case GHC.IO.Handle.Text.hPutStr2
                        GHC.IO.Handle.FD.stdout
                        FileServer.openSocket3
                        GHC.Types.True
                        ipv4 of ds3 { (#,#) ipv6 ipv7 ->
                 letrec {
                   a' :: GHC.Prim.State# GHC.Prim.RealWorld
                         -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
                     {- Arity: 1, Strictness: <S,U> -}
                   = \ (s1 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                     case ipv1 of ww { Network.Socket.Types.MkSocket ww1 ww2 ww3 ww4 ww5 ->
                     case ww5 of ww6 { GHC.MVar.MVar ww7 ->
                     case Network.$waccept
                            ww1
                            ww2
                            ww3
                            ww4
                            ww7
                            s1 of ds4 { (#,#) ipv8 ipv9 ->
                     case ipv9 of wild { (,,) handle host port ->
                     case GHC.IO.Handle.Text.hPutStr2
                            GHC.IO.Handle.FD.stdout
                            (GHC.CString.unpackAppendCString#
                               "Connection accepted: "#
                               (GHC.Base.++ @ GHC.Types.Char host FileServer.openSocket2))
                            GHC.Types.True
                            ipv8 of ds5 { (#,#) ipv10 ipv11 ->
                     case Control.Concurrent.forkFinally1
                            @ ()
                            (\ (w :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                             FileServer.$wrunConn
                               handle
                               (GHC.Conc.Sync.TVar
                                  @ (Data.Map.Base.Map GHC.Base.String FileServer.File)
                                  ipv5)
                               w)
                              `cast`
                            (Sym (GHC.Types.N:IO[0] <()>_R))
                            (\ (ds6 :: Data.Either.Either GHC.Exception.SomeException ())
                               (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                             GHC.IO.Handle.hClose1 handle eta)
                              `cast`
                            (<Data.Either.Either GHC.Exception.SomeException ()>_R
                             ->_R Sym (GHC.Types.N:IO[0] <()>_R))
                            ipv10 of ds6 { (#,#) ipv12 ipv13 ->
                     a' ipv12 } } } } } }
                 } in
                 a' ipv6 } } } }) -}
58ec3b290e44bbc9dabef5ba53b325bf
  openSocket2 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString# "\n"#) -}
7a3495e28bfd49ddc8099efd5e1ef7f2
  openSocket3 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   "Waiting for connections\n"#) -}
8fc88d0a9915ed4c1bc9eca8235e3e1c
  openSocket4 ::
    Network.Socket.Types.Socket
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 2, Strictness: <L,1*U(U(U),A,A,A,1*U(U))><S,U> -}
2842ffd5bb132b39e55c4d20009a680b
  readytoclose :: Network.Socket.Types.Socket -> GHC.Types.IO ()
  {- Arity: 2, Strictness: <L,1*U(U(U),A,A,A,1*U(U))><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.openSocket4
                  `cast`
                (<Network.Socket.Types.Socket>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
ac75836e1e5f0ff692539ab28574036e
  removeClientfromCacheList ::
    GHC.Base.String
    -> GHC.Types.Int -> FileServer.FileList -> GHC.Types.IO ()
  {- Arity: 4, Strictness: <S,1*U><S,U(U)><S(S),1*U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.removeClientfromCacheList1
                  `cast`
                (<GHC.Base.String>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R <FileServer.FileList>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
1da98e043d13cd25deeb22e24d764ab8
  removeClientfromCacheList1 ::
    GHC.Base.String
    -> GHC.Types.Int
    -> FileServer.FileList
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 4, Strictness: <S,1*U><S,U(U)><S(S),1*U(U)><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (4, True, False)
                (\ (w :: GHC.Base.String)
                   (w1 :: GHC.Types.Int)
                   (w2 :: FileServer.FileList)
                   (w3 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case w1 of ww { GHC.Types.I# ww1 ->
                 case w2 of ww2 { GHC.Conc.Sync.TVar ww3 ->
                 FileServer.$wremoveClientfromCacheList w ww1 ww3 w3 } }) -}
068877dbec5e42e5abf09788f8bbbda8
  removeClientfromCacheList2 :: GHC.Conc.Sync.STM ()
  {- Strictness: x -}
34297041988a56f79061e428f93e7037
  removeClientfromCacheList3 :: GHC.Conc.Sync.STM ()
  {- Strictness: x -}
d0d9bdea6eb4f21a716590cfe86b3240
  runConn ::
    GHC.IO.Handle.Types.Handle
    -> FileServer.FileList -> GHC.Types.Int -> GHC.Types.IO ()
  {- Arity: 4, Strictness: <S,U><L,U(U)><L,A><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.runConn1
                  `cast`
                (<GHC.IO.Handle.Types.Handle>_R
                 ->_R <FileServer.FileList>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
4a976000ea1ec4979889b045bb76899f
  runConn1 ::
    GHC.IO.Handle.Types.Handle
    -> FileServer.FileList
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 4, Strictness: <S,U><L,U(U)><L,A><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (4, True, True)
                (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: FileServer.FileList)
                   (w2 :: GHC.Types.Int)
                   (w3 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 FileServer.$wrunConn w w1 w3) -}
4f47b0675265b3e7e8cfe4d464e4dec9
  updateClientCache ::
    FileServer.FileList
    -> GHC.Base.String -> GHC.Types.Int -> GHC.Types.IO ()
  {- Arity: 4, Strictness: <S(S),1*U(U)><S,U><L,1*U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.updateClientCache1
                  `cast`
                (<FileServer.FileList>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
10a9c37b455b88ecbe09b96c2cb405d2
  updateClientCache1 ::
    FileServer.FileList
    -> GHC.Base.String
    -> GHC.Types.Int
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 4, Strictness: <S(S),1*U(U)><S,U><L,1*U(U)><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (4, True, False)
                (\ (w :: FileServer.FileList)
                   (w1 :: GHC.Base.String)
                   (w2 :: GHC.Types.Int)
                   (w3 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case w of ww { GHC.Conc.Sync.TVar ww1 ->
                 FileServer.$wupdateClientCache ww1 w1 w2 w3 }) -}
05b8cca2a792b05428e97fdad17145d2
  updateClientCache2 :: GHC.Types.IO ()
  {- Strictness: x -}
71d45ae1698bcb425e61dc18c74c914d
  writeFileList ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Base.String
    -> GHC.Types.Int
    -> FileServer.FileList
    -> GHC.Types.IO ()
  {- Arity: 6, Strictness: <L,U><S,U><L,1*U><L,U(U)><S(S),U(U)><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.writeFileList1
                  `cast`
                (<GHC.IO.Handle.Types.Handle>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <GHC.Base.String>_R
                 ->_R <GHC.Types.Int>_R
                 ->_R <FileServer.FileList>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
38b809dd784c519d76cd1f27b3a0e358
  writeFileList1 ::
    GHC.IO.Handle.Types.Handle
    -> GHC.Base.String
    -> GHC.Base.String
    -> GHC.Types.Int
    -> FileServer.FileList
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 6, Strictness: <L,U><S,U><L,1*U><L,U(U)><S(S),U(U)><S,U>,
     Inline: INLINE[0],
     Unfolding: InlineRule (6, True, False)
                (\ (w :: GHC.IO.Handle.Types.Handle)
                   (w1 :: GHC.Base.String)
                   (w2 :: GHC.Base.String)
                   (w3 :: GHC.Types.Int)
                   (w4 :: FileServer.FileList)
                   (w5 :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case w4 of ww { GHC.Conc.Sync.TVar ww1 ->
                 FileServer.$wwriteFileList w w1 w2 w3 ww1 w5 }) -}
d5867d928639bc221a21b4d67a3eb413
  writeFileList2 ::
    GHC.Base.String
    -> GHC.Base.String
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 3, Strictness: <L,U><L,1*U><S,U>,
     Unfolding: (\ (fileName :: GHC.Base.String)
                   (toWrite :: GHC.Base.String)
                   (eta :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                 case GHC.IO.Handle.FD.openFile1
                        fileName
                        GHC.IO.IOMode.WriteMode
                        eta of ds1 { (#,#) ipv ipv1 ->
                 case GHC.IO.Handle.Text.hPutStr2
                        ipv1
                        toWrite
                        GHC.Types.False
                        ipv of ds2 { (#,#) ipv2 ipv3 ->
                 GHC.IO.Handle.hClose1 ipv1 ipv2 } }) -}
3980bacbecdd1ef0f75b404c41357843
  writeFileandClose ::
    GHC.Base.String -> GHC.Base.String -> GHC.Types.IO ()
  {- Arity: 3, Strictness: <L,U><L,1*U><S,U>,
     Unfolding: InlineRule (0, True, True)
                FileServer.writeFileList2
                  `cast`
                (<GHC.Base.String>_R
                 ->_R <GHC.Base.String>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
vectorised variables:
vectorised tycons:
vectorised reused tycons:
parallel variables:
parallel tycons:
trusted: none
require own pkg trusted: False

